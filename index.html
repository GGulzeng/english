<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ÌÄ¥Ï¶à</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 40px;
      text-align: center;
      background-color: #f9f9f9;
    }
    h1 {
      font-size: 2.6em;
      margin-bottom: 30px;
      font-weight: bold;
      color: #333;
    }
    #main-menu {
      display: flex;
      justify-content: center;
      gap: 24px;
      margin-top: 40px;
    }
    #main-menu button {
      width: 360px;
      height: 360px;
      font-size: 44px;
      font-weight: bold;
      border-radius: 24px;
      border: none;
      cursor: pointer;
      color: #000;
      box-shadow: 0 6px 14px rgba(0, 0, 0, 0.1);
    }
    #main-menu button:nth-child(1) { background-color: #f28b82; }
    #main-menu button:nth-child(2) { background-color: #fbbc04; }
    .choices-container {
      display: flex;
      justify-content: space-around;
      flex-wrap: wrap;
      gap: 24px;
      margin-top: 30px;
    }
    .choice-btn {
      width: 40%;
      min-width: 300px;
      height: 120px;
      font-size: 22px;
      font-weight: bold;
      border-radius: 14px;
      background-color: #f3f3f3;
      border: 1px solid #ccc;
      cursor: pointer;
    }
    .correct { background-color: #a5d6a7 !important; }
    .incorrect { background-color: #ef9a9a !important; }
    #back-button {
      position: absolute;
      top: 20px;
      left: 20px;
      padding: 10px 16px;
      font-size: 16px;
      border-radius: 8px;
      border: none;
      background-color: #ccc;
      cursor: pointer;
    }
    #feedback {
      margin-top: 24px;
      font-weight: bold;
      font-size: 18px;
    }
    #quiz-box p { font-size: 70px; }
    #quiz-box p strong { font-size: 80px; }
    button.pronounce {
      font-size: 24px;
      padding: 12px 20px;
    }
    #progress {
      font-size: 24px;
      margin-bottom: 20px;
    }
    #result-modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .modal-box {
      background: #fff;
      padding: 40px;
      border-radius: 20px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.2);
      text-align: center;
      max-width: 500px;
      width: 80%;
    }
    #result-icon {
      font-size: 64px;
      margin-bottom: 20px;
    }
    #result-title {
      font-size: 36px;
      margin-bottom: 16px;
      color: #333;
    }
    #result-message {
      font-size: 20px;
      color: #555;
    }
    .next-info {
      font-size: 14px;
      color: #888;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h1>Ïò§ÎäòÏùò ÏòÅÏñ¥ÌÄ¥Ï¶à</h1>
  <div id="main-menu">
    <button onclick="startQuiz('elementary')">Level 1</button>
    <button onclick="startQuiz('middle')">Level 2</button>
  </div>

  <div id="quiz-screen" style="display: none;">
    <div id="progress"></div>
    <button id="back-button" onclick="goBack()">‚Üê Îí§Î°úÍ∞ÄÍ∏∞</button>
    <div id="quiz-box"></div>
    <div id="feedback"></div>
  </div>

  <div id="result-modal">
    <div class="modal-box">
      <div id="result-icon">üéâ</div>
      <h2 id="result-title"></h2>
      <p id="result-message"></p>
      <p class="next-info">10Ï¥à ÌõÑ Î©îÏù∏ÌôîÎ©¥ÏúºÎ°ú ÎèåÏïÑÍ∞ëÎãàÎã§...</p>
    </div>
  </div>

  <audio id="correct-audio" src="Ï†ïÎãµ.mp3"></audio>
  <audio id="wrong-audio" src="Ïò§Îãµ.mp3"></audio>
  <audio id="cheer-audio" src="Ï¥àÎì±ÌïôÏÉù ÌôòÌò∏ÏÜåÎ¶¨.mp3"></audio>

  <script src="quizzes.js"></script>
  <script>
    let currentLevel = '';
    let quizQueue = [];
    let currentIndex = 0;
    let correctCount = 0;

    function startQuiz(level) {
      document.getElementById('main-menu').style.display = 'none';
      document.getElementById('quiz-screen').style.display = 'block';
      document.getElementById("result-modal").style.display = 'none';
      currentLevel = level;
      correctCount = 0;
      quizQueue = quizzes[level].slice().sort(() => 0.5 - Math.random());
      currentIndex = 0;
      showNextQuiz();
    }

    function goBack() {
      document.getElementById('quiz-screen').style.display = 'none';
      document.getElementById('main-menu').style.display = 'flex';
      document.getElementById('quiz-box').innerHTML = '';
      document.getElementById('feedback').textContent = '';
      document.getElementById('progress').textContent = '';
    }

    function showNextQuiz() {
      document.getElementById("feedback").textContent = "";
      document.getElementById("progress").textContent = `${currentIndex + 1} / 10`;
      const box = document.getElementById("quiz-box");
      if (currentIndex >= 10 || currentIndex >= quizQueue.length) {
        showResultModal();
        return;
      }
      const quiz = quizQueue[currentIndex++];
      const word = quiz.question.match(/'(.*?)'/)[1];
      const currentAnswer = quiz.answer.trim();
      const allAnswers = quizzes[currentLevel].map(q => q.answer.trim()).filter(a => a);
      const shuffled = allAnswers.filter(a => a !== currentAnswer).sort(() => 0.5 - Math.random()).slice(0, 3);
      shuffled.push(currentAnswer);
      const choices = shuffled.sort(() => 0.5 - Math.random());

      const buttonsHTML = '<div class="choices-container">' + choices.map(choice =>
        `<button class="choice-btn" onclick="checkAnswer(this, '${currentAnswer}')">${choice}</button>`
      ).join("") + '</div>';

      box.innerHTML = `
        <p><strong>${quiz.question}</strong></p>
        <button class="pronounce" onclick="speak('${word}')">üîä Î∞úÏùå Îì£Í∏∞</button>
        <audio id="audio-${word.toLowerCase()}" src="tts/${word.toLowerCase()}.mp3"></audio>
        ${buttonsHTML}
      `;

      speak(word);
    }

    function checkAnswer(button, correctAnswer) {
      const userChoice = button.textContent.trim();
      const buttons = document.querySelectorAll(".choice-btn");

      if (userChoice === correctAnswer) {
        document.getElementById("correct-audio").play();
        button.classList.add("correct");
        correctCount++;
        buttons.forEach(btn => btn.disabled = true);
        document.getElementById("feedback").textContent = "Ï†ïÎãµÏûÖÎãàÎã§!";
        document.getElementById("feedback").style.color = "green";
        setTimeout(showNextQuiz, 2000);
      } else {
        document.getElementById("wrong-audio").play();
        button.classList.add("incorrect");
        buttons.forEach(btn => {
          if (btn.textContent.trim() === correctAnswer) {
            btn.classList.add("correct");
          }
          btn.disabled = true;
        });
        document.getElementById("feedback").textContent = "Ïò§ÎãµÏûÖÎãàÎã§. Ï†ïÎãµÏùÄ '" + correctAnswer + "' ÏûÖÎãàÎã§.";
        document.getElementById("feedback").style.color = "red";
        setTimeout(showNextQuiz, 2000);
      }
    }

    function speak(word) {
      const audioId = "audio-" + word.toLowerCase();
      const audio = document.getElementById(audioId);
      if (audio) {
        audio.currentTime = 0;
        audio.play();
      }
    }

    function showResultModal() {
      const cheerAudio = document.getElementById("cheer-audio");
      if (cheerAudio) {
        cheerAudio.currentTime = 0;
        cheerAudio.play().catch(e => console.warn("Autoplay blocked:", e));
      }
      const icon = document.getElementById("result-icon");
      const title = document.getElementById("result-title");
      const message = document.getElementById("result-message");

      let text = "";
      let emoji = "üôÇ";

      if (correctCount <= 2) {
        text = "ÏãúÏûëÏù¥ Î∞òÏù¥ÏóêÏöî! ÏßÄÍ∏àÏùÄ ÎßéÏù¥ ÌãÄÎ†∏ÏßÄÎßå, Î∞òÎ≥µÌï¥ÏÑú Ïó∞ÏäµÌïòÎ©¥ ÎàÑÍµ¨ÎÇò Ïã§Î†•Ïù¥ ÎäòÏñ¥Ïöî.";
        emoji = "üåÄ";
      } else if (correctCount <= 4) {
        text = "Ï°∞Í∏àÏî© ÏùµÏàôÌï¥ÏßÄÍ≥† ÏûàÏñ¥Ïöî. ÏûêÏ£º ÎÇòÏò§Îäî Îã®Ïñ¥Î•º Î©îÎ™®Ìï¥ÏÑú Ïô∏ÏõåÎ≥¥Îäî Í≤ÉÎèÑ Ï¢ãÏïÑÏöî.";
        emoji = "üìù";
      } else if (correctCount <= 6) {
        text = "Î∞ò Ïù¥ÏÉÅ ÎßûÏ∑ÑÏñ¥Ïöî! Í∏∞Ï¥àÎäî Ïûò ÎêòÏñ¥ ÏûàÏñ¥Ïöî. ÌãÄÎ¶∞ Îã®Ïñ¥Îäî ÏòàÎ¨∏ ÏÜçÏóêÏÑú Îã§Ïãú ÏùµÌòÄÎ≥¥ÏÑ∏Ïöî.";
        emoji = "üìö";
      } else if (correctCount === 7) {
        text = "ÏûòÌïòÍ≥† ÏûàÏñ¥Ïöî! Ïú†ÏÇ¨Ìïú Îã®Ïñ¥ÏôÄ Ìï®Íªò Ïô∏ÏõåÎ≥¥Î©¥ Îçî Ï¢ãÏïÑÏöî.";
        emoji = "üëç";
      } else if (correctCount === 8) {
        text = "Î©ãÏ†∏Ïöî! Ïã§ÏàòÎ•º Ï§ÑÏù¥Î†§Î©¥ Î¨∏Ï†úÎ•º Ï≤úÏ≤úÌûà Îã§Ïãú ÏùΩÏñ¥Î≥¥Îäî ÏäµÍ¥ÄÏùÑ Îì§Ïù¥ÏÑ∏Ïöî.";
        emoji = "üåü";
      } else if (correctCount === 9) {
        text = "ÌõåÎ•≠Ìï¥Ïöî! ÌãÄÎ¶∞ Îã®Ïñ¥ ÌïòÎÇòÎßå Î≥µÏäµÌïòÎ©¥ ÏôÑÎ≤ΩÌï¥Ïßà Ïàò ÏûàÏñ¥Ïöî.";
        emoji = "üí°";
      } else {
        text = "ÏôÑÎ≤ΩÌï¥Ïöî! Ïò§Îäò ÌïôÏäµÌïú Îã®Ïñ¥Îì§ÏùÑ Ïã§Ï†ú Î¨∏Ïû•ÏóêÏÑú ÏÇ¨Ïö©Ìï¥Î≥¥Î©¥ Îçî Ïò§Îûò Í∏∞ÏñµÌï† Ïàò ÏûàÏñ¥Ïöî.";
        emoji = "üéâ";
      }

      icon.textContent = emoji;
      title.textContent = `${correctCount} / 10`;
      message.textContent = text;

      document.getElementById("result-modal").style.display = "flex";
      setTimeout(() => {
        goBack();
        document.getElementById("result-modal").style.display = "none";
      }, 10000);
    }
  </script>
</body>
</html>